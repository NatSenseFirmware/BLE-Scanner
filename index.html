<!doctype html>
<html>

    <head>
        <title>BLE Scanner</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
       
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
        <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css">
        <link rel="stylesheet" href="styles.css" />
        <link rel="manifest" href="manifest.json" />

        <script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>

    </head>

    <body>
        <div class="app-layout mdl-layout mdl-js-layout">
            <main class="mdl-layout__content">
                <div class="mdl-grid">
                    <div class="mdl-cell mdl-cell--6-col">
                        <div class="mdl-textfield mdl-js-textfield">
                          <input class="mdl-textfield__input" type="text" id="service" value="0000ffe0-0000-1000-8000-00805f9b34fb">
                          <label class="mdl-textfield__label" for="sample1">Service</label>
                        </div>

                        <div class="mdl-textfield mdl-js-textfield">
                            <input class="mdl-textfield__input" type="text" id="characteristic" value="0000ffe1-0000-1000-8000-00805f9b34fb">
                            <label class="mdl-textfield__label" for="sample2">Characteristic</label>
                        </div>

                        <div>
                            <label for="serviceSelect">Service (discovered)</label>
                            <select id="serviceSelect"></select>
                        </div>
                        <div>
                            <label for="characteristicSelect">Characteristic (discovered)</label>
                            <select id="characteristicSelect"></select>
                        </div>
                  
                        <div class="mdl-card__actions mdl-card--border">
                            <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="read()" id="read" disabled>
                                Read
                            </a>
                            <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="write()" id="write" disabled>
                                Write
                            </a>
                            <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="subscribe()" id="subscribe" disabled>
                                Subscribe
                            </a>
                            <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="unsubscribe()" id="unsubscribe" disabled>
                                Unsubscribe
                            </a>
                        </div>
                    </div>
                    <div class="mdl-cell mdl-cell--6-col">
                        <div class="mdl-textfield mdl-js-textfield">
                            <textarea class="mdl-textfield__input" type="text" rows= "5" id="value" ></textarea>
                            <label class="mdl-textfield__label" for="value">Value</label>
                        </div>
                        <div>
                            <label for="valueFormat">Value Format</label>
                            <select id="valueFormat">
                                <option value="Auto" selected>Auto (by UUID)</option>
                                <option value="Hex">Hex</option>
                                <option value="UTF8">UTF-8</option>
                                <option value="Base64">Base64</option>
                                <option value="Bits">Bits</option>
                                <option value="Uint8">Uint8</option>
                                <option value="Int8">Int8</option>
                                <option value="Uint16LE">Uint16 LE</option>
                                <option value="Uint16BE">Uint16 BE</option>
                                <option value="Int16LE">Int16 LE</option>
                                <option value="Int16BE">Int16 BE</option>
                                <option value="Uint32LE">Uint32 LE</option>
                                <option value="Uint32BE">Uint32 BE</option>
                                <option value="Int32LE">Int32 LE</option>
                                <option value="Int32BE">Int32 BE</option>
                                <option value="Float32LE">Float32 LE</option>
                                <option value="Float32BE">Float32 BE</option>
                            </select>
                        </div>
                        <div>
                            <label for="writeMode">Write Mode</label>
                            <select id="writeMode">
                                <option value="Auto">Auto</option>
                                <option value="WithResponse">With Response</option>
                                <option value="WithoutResponse">Without Response</option>
                                <option value="Generic">Generic</option>
                            </select>
                        </div>
                        <div>
                            <label for="writeTerminator">Write Terminator</label>
                            <select id="writeTerminator">
                                <option value="None">None</option>
                                <option value="LF">LF (\n)</option>
                                <option value="CR">CR (\r)</option>
                                <option value="CRLF">CRLF (\r\n)</option>
                            </select>
                        </div>
                        <div>
                            <label for="autoReadAfterWrite">
                                <input type="checkbox" id="autoReadAfterWrite" /> Auto read after write
                            </label>
                        </div>
                        <div class="mdl-textfield mdl-js-textfield">
                            <textarea class="mdl-textfield__input" type="text" rows="10" id="stream"></textarea>
                            <label class="mdl-textfield__label" for="stream">Stream</label>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <dialog class="mdl-dialog">
            <h4 class="mdl-dialog__title">Connect</h4>
            <div class="mdl-dialog__content">

                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <input class="mdl-textfield__input" type="text" id="optionalServices" placeholder="Bluetooth Services (e.g. generic_access, 0x1234)" required=true value="0000ffe0-0000-1000-8000-00805f9b34fb"/>
                    <label class="mdl-textfield__label" for="optionalServices">Services</label>
                    <span class="mdl-textfield__error">Required</span>
                </div>

                <div id = "progressbar" class = "mdl-progress mdl-js-progress mdl-progress__indeterminate hidden"></div>
                
                <div class="mdl-dialog__actions mdl-dialog__actions--full-width ">
                    <button type="button" class="connect-button mdl-button mdl-js-button mdl-button--raised mdl-button--colored">
                        <i class="material-icons">bluetooth</i> Connect
                    </button>
                </div>
            </div>
            
        </dialog>

        <div aria-live="assertive" aria-atomic="true" aria-relevant="text" class="mdl-snackbar mdl-js-snackbar">
                <div class="mdl-snackbar__text"></div>
                <button type="button" class="mdl-snackbar__action"></button>
            </div>
        <script src="app.js"></script>

        <script>
            var dialog = document.querySelector('dialog');
            var showModalButton = document.querySelector('.show-modal');
            if (! dialog.showModal) {
                dialogPolyfill.registerDialog(dialog);
            }
            dialog.querySelector('.connect-button').addEventListener('click', function() {
                //dialog.close();
                connect();
            });
    
            dialog.showModal();
        </script>
    </body>
</html>